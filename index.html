<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Simple MTG Table</title>
  <style>
    body, html { margin: 0; padding: 0; height: 100%; }
    #game { display: grid; grid-template-areas: "board" "hand"; grid-template-rows: 1fr auto; height: 100vh; }
    #board { grid-area: board; position: relative; background: #2d7b2d; }

    /* Hand styling: horizontal cushion only */
    #hand {
      grid-area: hand;
      background: #444;
      padding: 10px 20px;       /* horizontal cushion */
      display: flex;
      gap: 10px;
      overflow-x: auto;
      width: 100%;
      min-height: 140px;
      justify-content: flex-start;  /* align cards to left */
      align-items: center;
      scrollbar-width: thin;
    }
    #hand::-webkit-scrollbar { height: 8px; }
    #hand::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 4px; }

    /* Zone tiles */
    #zones-wrapper { display: flex; gap: 20px; position: absolute; top: 10px; left: 10px; }
    .zone { border: 2px dashed #aaa; padding: 10px; background: rgba(255,255,255,0.2); position: relative; cursor: pointer; }
    /* Fixed size for pile zones */
    #deck, #graveyard, #exile { width: 100px; height: 140px; }
    .zone-title { text-align: center; font-weight: bold; color: white; margin-bottom: 5px; pointer-events: none; }
    .count { position: absolute; bottom: 4px; right: 4px; font-size: 12px; color: white; background: rgba(0,0,0,0.6); padding: 2px 4px; border-radius: 4px; pointer-events: none; }

    /* Card styling */
    .card { width: 80px; height: 120px; border: 1px solid #000; border-radius: 5px; background: white; position: relative; user-select: none; cursor: grab; }
    .card.face-down { background: #333; }
    .card .label { position: absolute; bottom: 5px; left: 5px; font-size: 12px; color: black; }
    .card.tapped { transform: rotate(90deg); }

    /* Modal List display */
    #list-modal {
      position: absolute;
      top: 50%; left: 50%; transform: translate(-50%, -50%);
      background: #fff; border: 1px solid #000;
      padding: 10px;
      width: 80%; max-width: 600px; height: 200px;
      display: none; z-index: 100;
    }
    #list-modal h3 { margin: 0 0 10px 0; }
    #list-hand { display: flex; gap: 10px; overflow-x: auto; align-items: center; }
    #list-modal button { margin-top: 10px; float: right; }
  </style>
</head>
<body>
  <div id="game">
    <div id="board">
      <div id="zones-wrapper">
        <div id="deck" class="zone">
          <div class="zone-title">Deck<br>(click to draw)</div>
          <div class="count" id="deck-count">0</div>
        </div>
        <div id="graveyard" class="zone">
          <div class="zone-title">Graveyard<br>(click to view)</div>
          <div class="count" id="graveyard-count">0</div>
        </div>
        <div id="exile" class="zone">
          <div class="zone-title">Exile<br>(click to view)</div>
          <div class="count" id="exile-count">0</div>
        </div>
      </div>
    </div>
    <div id="hand">
      <div class="zone-title" style="color: #fff; pointer-events: none;">Your Hand</div>
    </div>
    <div id="list-modal">
      <h3 id="list-modal-title"></h3>
      <div id="list-hand"></div>
      <button id="list-modal-close">Close</button>
    </div>
  </div>

  <script>
    const deck = [];
    const graveyardCards = [];
    const exileCards = [];
    for (let i = 1; i <= 60; i++) deck.push({ id: i, name: `Card ${i}` });

    const zones = {
      hand: document.getElementById('hand'),
      board: document.getElementById('board'),
      deck: document.getElementById('deck'),
      graveyard: document.getElementById('graveyard'),
      exile: document.getElementById('exile'),
    };
    const counts = {
      deck: document.getElementById('deck-count'),
      graveyard: document.getElementById('graveyard-count'),
      exile: document.getElementById('exile-count'),
    };
    const modal = document.getElementById('list-modal');
    const modalTitle = document.getElementById('list-modal-title');
    const listHand = document.getElementById('list-hand');
    const modalClose = document.getElementById('list-modal-close');

    let currentList = null;

    function updateCounts() {
      counts.deck.textContent = deck.length;
      counts.graveyard.textContent = graveyardCards.length;
      counts.exile.textContent = exileCards.length;
    }

    function showList(title, list) {
      currentList = list;
      modalTitle.textContent = title;
      listHand.innerHTML = '';
      list.forEach(data => {
        const c = createCard(data);
        c.style.cursor = 'pointer';
        c.addEventListener('click', () => {
          const idx = currentList.findIndex(d => d.id === data.id);
          if (idx !== -1) currentList.splice(idx, 1);
          const returned = createCard(data);
          zones.hand.appendChild(returned);
          zones.hand.scrollLeft = 0; // ensure view starts at left
          updateCounts();
          modal.style.display = 'none';
        });
        listHand.appendChild(c);
      });
      modal.style.display = 'block';
    }

    modalClose.addEventListener('click', () => { modal.style.display = 'none'; });

    zones.deck.addEventListener('click', () => {
      if (!deck.length) return;
      const data = deck.shift();
      const cardEl = createCard(data);
      zones.hand.appendChild(cardEl);
      zones.hand.scrollLeft = 0; // reset scroll
      updateCounts();
    });

    zones.graveyard.addEventListener('click', () => showList('Graveyard', graveyardCards));
    zones.exile.addEventListener('click', () => showList('Exile', exileCards));

    function createCard(data) {
      const card = document.createElement('div');
      card.className = 'card';
      card.id = `card-${data.id}`;
      card.draggable = true;
      card.dataset.id = data.id;
      card.dataset.name = data.name;

      const label = document.createElement('div');
      label.className = 'label';
      label.textContent = data.name;
      card.appendChild(label);

      card.addEventListener('dragstart', e => void e.dataTransfer.setData('text/plain', card.id));
      card.addEventListener('dblclick', () => card.classList.toggle('tapped'));
      card.addEventListener('contextmenu', e => { e.preventDefault(); card.classList.toggle('face-down'); });
      card.addEventListener('click', e => { if (e.shiftKey) card.classList.toggle('face-down'); });

      return card;
    }

    ['hand', 'board', 'graveyard', 'exile'].forEach(zoneName => {
      const zone = zones[zoneName];
      zone.addEventListener('dragover', e => e.preventDefault());
      zone.addEventListener('drop', e => {
        e.preventDefault();
        const id = e.dataTransfer.getData('text/plain');
        const card = document.getElementById(id);
        if (!card) return;
        if (zoneName === 'graveyard' || zoneName === 'exile') e.stopPropagation();
        [graveyardCards, exileCards].forEach(arr => {
          const idx = arr.findIndex(d => d.id == card.dataset.id);
          if (idx !== -1) arr.splice(idx, 1);
        });
        if (zoneName === 'board') {
          const rect = zone.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;
          card.style.position = 'absolute'; card.style.left = `${x - card.offsetWidth/2}px`;
          card.style.top = `${y - card.offsetHeight/2}px`; zone.appendChild(card);
        } else if (zoneName === 'graveyard') {
          graveyardCards.push({ id: parseInt(card.dataset.id), name: card.dataset.name }); card.remove(); updateCounts();
        } else if (zoneName === 'exile') {
          exileCards.push({ id: parseInt(card.dataset.id), name: card.dataset.name }); card.remove(); updateCounts();
        } else {
          card.style.position = ''; card.style.left = ''; card.style.top = '';
          zone.appendChild(card);
        }
      });
    });

    updateCounts();
  </script>
</body>
</html>
