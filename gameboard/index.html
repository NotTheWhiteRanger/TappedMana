<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Commander Gameboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-start: #0f172a;
      --bg-end: #1e293b;
      --zone-bg: rgba(255, 255, 255, 0.05);
      --zone-border: rgba(255, 255, 255, 0.15);
      --padding: 10px;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(to bottom, var(--bg-start), var(--bg-end));
      color: white;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .gameboard {
      display: grid;
      grid-template-columns: 100px 1fr 100px;
      grid-template-rows: 120px auto 120px auto 120px;
      gap: 10px;
      width: 95vw;
      height: 95vh;
      padding: var(--padding);
      background: var(--zone-bg);
      border-radius: 1rem;
    }
    .zone {
      background: var(--zone-bg);
      border: 2px solid var(--zone-border);
      border-radius: 0.75rem;
      padding: var(--padding);
      text-align: center;
      position: relative;
      box-shadow: inset 0 0 10px rgba(255,255,255,0.05);
      overflow: hidden;
    }
    .zone .count {
      position: absolute;
      bottom: 4px;
      right: 6px;
      font-size: 0.75rem;
      color: #facc15;
    }
    .monster-zone, .mana-zone {
      display: flex;
      justify-content: center;
      align-items: center;
      border: 2px dashed rgba(255,255,255,0.2);
      font-weight: bold;
    }
    .opponent-mana-zone { grid-column: 2; grid-row: 1; }
    .opponent-monster-zone { grid-column: 2; grid-row: 2; }
    .opponent-commander {
      grid-column: 1;
      grid-row: 3;
      clip-path: polygon(50% 0%, 93% 25%, 93% 75%, 50% 100%, 7% 75%, 7% 25%);
      background: rgba(255,255,255,0.08);
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: bold;
    }
    .opponent-life-counter { grid-column: 3; grid-row: 2; }
    .opponent-exile { grid-column: 1; grid-row: 1; }
    .opponent-graveyard { grid-column: 1; grid-row: 2; }
    .opponent-library { grid-column: 3; grid-row: 1; }
    .player-monster-zone { grid-column: 2; grid-row: 4; }
    .player-mana-zone { grid-column: 2; grid-row: 5; }
    .exile { grid-column: 1; grid-row: 4; cursor: pointer; }
    .graveyard { grid-column: 1; grid-row: 5; cursor: pointer; }
    .library { grid-column: 3; grid-row: 5; }
    .commander {
      grid-column: 3;
      grid-row: 3;
      clip-path: polygon(50% 0%, 93% 25%, 93% 75%, 50% 100%, 7% 75%, 7% 25%);
      background: rgba(255,255,255,0.08);
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: bold;
    }
    .life-counter { grid-column: 3; grid-row: 4; }
    .life-counter, .opponent-life-counter {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      background: rgba(255,255,255,0.08);
      padding: 6px 12px;
      border-radius: 10px;
      box-shadow: 0 0 6px rgba(255,255,255,0.1);
    }
    .life-counter button, .opponent-life-counter button {
      background: #3b82f6;
      color: white;
      border-radius: 6px;
      padding: 4px 10px;
      font-weight: bold;
      border: none;
      cursor: pointer;
    }
    .card {
      width: 80px;
      height: 112px;
      border-radius: 8px;
      cursor: grab;
      transition: transform 0.2s, opacity 0.2s ease, top 0.2s ease;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
      animation: drop-in 0.2s ease;
    }
    .card.tapped { transform: rotate(90deg); }
    @keyframes drop-in {
      from { transform: translateY(-20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    .zoom-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.85);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .zoom-overlay img {
      max-height: 90vh;
      max-width: 90vw;
      border-radius: 10px;
      box-shadow: 0 0 30px rgba(0,0,0,0.9);
    }
    .hand {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
    }
    .card-viewer {
  position: fixed;
  top: 50%;
  right: 10px;
  transform: translateY(-50%);
  background: rgba(0,0,0,0.95);
  padding: 10px;
  border-radius: 10px;
  display: none;
  flex-direction: row;
  flex-wrap: wrap;
  gap: 10px;
  z-index: 1100;
  max-height: 80vh;
  width: 520px;
  overflow-y: auto;
  align-content: flex-start;
}
    .card-viewer img {
  width: 100px;
  height: auto;
  border-radius: 6px;
}
    .card-viewer .close-btn {
      align-self: flex-end;
      background: #ef4444;
      color: white;
      border: none;
      padding: 4px 8px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <main class="gameboard">
    <div class="zone opponent-mana-zone">Opponent Mana Zone</div>
    <div class="zone opponent-monster-zone">Opponent Monster Zone</div>
    <div class="zone opponent-commander">Opponent Commander</div>
    <div class="zone opponent-life-counter">
      <button data-action="decrease" data-target="opponentLifeTotal">-</button>
      <span id="opponentLifeTotal">40</span>
      <button data-action="increase" data-target="opponentLifeTotal">+</button>
    </div>
    <div class="zone opponent-exile">Opponent Exile <span class="count" id="opponentExileCount">0</span></div>
    <div class="zone opponent-graveyard">Opponent Graveyard <span class="count" id="opponentGraveyardCount">0</span></div>
    <div class="zone opponent-library">Opponent Library <span class="count" id="opponentLibraryCount">0</span></div>
    <div class="zone player-monster-zone drop-zone">Monster Zone</div>
    <div class="zone player-mana-zone drop-zone">Mana Zone</div>
    <div class="zone exile drop-zone">Exile <span class="count" id="exileCount">0</span></div>
    <div class="zone graveyard drop-zone">Graveyard <span class="count" id="graveyardCount">0</span></div>
    <div class="zone library drop-zone">Library <span class="count" id="libraryCount">0</span></div>
    <div class="zone commander">Commander</div>
    <div class="zone life-counter">
      <button data-action="decrease" data-target="lifeTotal">-</button>
      <span id="lifeTotal">40</span>
      <button data-action="increase" data-target="lifeTotal">+</button>
    </div>
  </main>
  <div class="hand" id="hand"></div>
  <div class="card-viewer" id="cardViewer">
    <button class="close-btn" onclick="document.getElementById('cardViewer').style.display='none'">Close</button>
  </div>
<script>
  const hand = document.getElementById('hand');
  const exampleCards = [
    "Sol Ring",
    "Lightning Bolt",
    "Counterspell",
    "Island",
    "Black Lotus"
  ];

  function zoomCard(src) {
    const overlay = document.createElement("div");
    overlay.className = "zoom-overlay";
    overlay.onclick = () => overlay.remove();
    const img = document.createElement("img");
    img.src = src;
    overlay.appendChild(img);
    document.body.appendChild(overlay);
  }

  function createCard(card) {
  const img = document.createElement('img');
  img.className = 'card';
  img.draggable = true;
  img.dataset.normal = card.image_uris.normal;
  img.src = card.image_uris.small;
  img.ondblclick = () => zoomCard(card.image_uris.normal);
  img.ondragstart = e => {
    e.dataTransfer.setData("text/plain", JSON.stringify({
      small: card.image_uris.small,
      normal: card.image_uris.normal
    }));
    setTimeout(() => img.remove(), 0);
  };
  // No tap in hand zone
  hand.appendChild(img);
  }

  document.querySelectorAll(".drop-zone").forEach(zone => {
    zone.ondragover = e => e.preventDefault();
    zone.ondrop = e => {
      e.preventDefault();
      const data = JSON.parse(e.dataTransfer.getData("text/plain"));
      const img = document.createElement("img");
      img.className = "card";
      img.src = data.small;
      img.draggable = true;
      img.ondblclick = () => zoomCard(data.normal);
      if (!zone.classList.contains("graveyard") && !zone.classList.contains("exile")) {
        img.onclick = () => img.classList.toggle("tapped");
      }
      img.ondragstart = ev => {
        ev.dataTransfer.setData("text/plain", JSON.stringify(data));
        setTimeout(() => img.remove(), 0);
      };
      zone.appendChild(img);

      // Update card counts
      if (zone.classList.contains("graveyard")) updateZoneCount("graveyard", "graveyardCount");
      if (zone.classList.contains("exile")) updateZoneCount("exile", "exileCount");
      if (zone.classList.contains("library")) updateZoneCount("library", "libraryCount");

      // Update viewer logic
      if (zone.classList.contains("graveyard")) {
        document.querySelector('.graveyard').onclick = () => showZoneCards("graveyard");
      } else if (zone.classList.contains("exile")) {
        document.querySelector('.exile').onclick = () => showZoneCards("exile");
      }

      img.style.position = "absolute";
      img.style.top = `${zone.children.length * 2}px`;
      img.style.left = `${zone.children.length * 2}px`;
    };
  });

  exampleCards.forEach(name => {
    fetch(`https://api.scryfall.com/cards/named?exact=${encodeURIComponent(name)}`)
      .then(res => res.json())
      .then(createCard)
      .catch(err => console.error("Card load error:", name, err));
  });
function showZoneCards(zoneName) {
  const zone = document.querySelector(`.${zoneName}`);
  const viewer = document.getElementById('cardViewer');
  viewer.innerHTML = '<div style="display:flex; justify-content:space-between; align-items:center; width:100%">'
    + '<h3 style="margin:0; font-size:1.1rem">' + zoneName.charAt(0).toUpperCase() + zoneName.slice(1) + '</h3>'
    + '<button class="close-btn" onclick="document.getElementById(\'cardViewer\').style.display=\'none\'">Close</button>'
    + '</div>';
  const wrapper = document.createElement('div');
  wrapper.style.display = 'flex';
  wrapper.style.flexWrap = 'wrap';
  wrapper.style.gap = '10px';
  wrapper.style.marginTop = '10px';
  viewer.appendChild(wrapper);

  [...zone.querySelectorAll('img')].forEach(card => {
    const copy = card.cloneNode();
    copy.className = 'card';
    copy.style.position = 'static';
    copy.onclick = null;
    wrapper.appendChild(copy);
  });
  viewer.style.display = 'flex';
}

function updateZoneCount(zoneClass, countId) {
  const zone = document.querySelector(`.${zoneClass}`);
  const countEl = document.getElementById(countId);
  if (zone && countEl) {
    const cardCount = zone.querySelectorAll('img').length;
    countEl.textContent = cardCount;
  }
}
</script>
</body>
</html>
